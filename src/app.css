/* Google Fonts */
@import url('https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&display=swap');
@import 'tailwindcss';

@plugin '@tailwindcss/forms';
@plugin '@tailwindcss/typography';

/* Tailwind v4 custom font definitions */
@theme {
  --font-serif: 'Source Serif 4', Georgia, serif;
}

/*
  Vitesse-based Color Scheme
  This system defines a core palette and then maps it to component-specific variables.
*/
:root {
  /* Core Vitesse Light Palette */
  --v-bg: #ffffff;
  --v-bg-soft: #f7f7f7;
  --v-border: #f0f0f0;
  --v-text: #393a34;
  --v-text-muted: #6a737d;
  --v-primary: #1c6b48; /* Vitesse's green/teal accent */
  --v-primary-text: #ffffff;
  --v-warning: #a65e2b;
  --v-shadow-color: #222222;

  /* General variables mapped to the Vitesse palette */
  --bg-color: var(--v-bg);
  --text-color: var(--v-text);
  --muted-color: var(--v-text-muted);

  /* Component-specific variables */
  --header-bg: color-mix(in srgb, var(--v-bg), transparent 30%); /* Equivalent to 70% opacity */
  --header-border: var(--v-border);
  --toggle-border: var(--v-border);
  --toggle-active-bg: var(--v-bg-soft);
  --toggle-inactive-hover-bg: var(--v-bg-soft);

  /* PageMenu variables */
  --link-hover-color: var(--v-primary);
  --menu-bg: var(--v-bg);
  --menu-border: var(--v-border);
  --menu-item-hover-bg: var(--v-bg-soft);

  /* Button variables */
  --share-button-bg: var(--v-bg);
  --share-button-hover-bg: var(--v-bg-soft);

  /* Blog-specific variables */

  /* Blog tags (using primary accent) */
  --blog-tag-bg: color-mix(in srgb, var(--v-primary), transparent 85%);
  --blog-tag-text: var(--v-primary);
  --blog-tag-border: color-mix(in srgb, var(--v-primary), transparent 75%);

  /* Blog title */
  --blog-title-color: var(--v-text);
  --blog-meta-color: var(--v-text-muted);

  /* Blog table of contents */
  --blog-toc-bg: var(--v-bg);
  --blog-toc-border: var(--v-border);
  --blog-toc-heading: var(--v-text-muted);
  --blog-toc-link: var(--v-primary);
  --blog-toc-link-hover: var(--v-primary);

  /* Blog Tip (using warning color) */
  --blog-tip-bg: color-mix(in srgb, var(--v-warning), transparent 90%);
  --blog-tip-text: var(--v-warning);
  --blog-tip-border: color-mix(in srgb, var(--v-warning), transparent 70%);
  --blog-tip-inline-code-bg: color-mix(in srgb, var(--v-warning), transparent 80%);
  --blog-tip-inline-code-text: var(--v-warning);

  /* Blog code */
  --blog-code-bg: var(--v-bg-soft);
  --blog-code-border: var(--v-border);

  /* Blog prose headings */
  --blog-prose-headings: var(--v-text);

  /* Typography */
  --font-serif: 'Source Serif 4', Georgia, serif;

  /* Blog inline code */
  --blog-inline-code-bg: var(--v-bg-soft);
  --blog-inline-code-text: var(--v-text);

  /* Blog page variables */
  --blog-description-color: var(--v-text-muted);
  --blog-empty-border: var(--v-border);
  --blog-empty-heading: var(--v-text);
  --blog-empty-text: var(--v-text-muted);

  /* Blog post card variables */
  --blog-card-bg: var(--v-bg);
  --blog-card-border: var(--v-border);
  --blog-card-shadow: color-mix(in srgb, var(--v-shadow-color), transparent 95%);
  --blog-card-shadow-hover: color-mix(in srgb, var(--v-shadow-color), transparent 90%);
  --blog-card-title-color: var(--v-text);
  --blog-card-summary-color: var(--v-text-muted);
  --blog-card-footer-color: var(--v-text-muted);
  --blog-card-tag-category-color: var(--v-primary);

  /* Homepage variables */
  --homepage-title-color: var(--v-text);
  --homepage-title-hover-color: var(--v-primary);
  --homepage-meta-color: var(--v-text-muted);
  --homepage-summary-color: var(--v-text-muted);
  --homepage-empty-text-color: var(--v-text-muted);

  /* Navigation variables */
  --nav-link-color: var(--v-primary);
  --nav-link-hover-color: var(--v-primary);

  /* Button variables */
  --primary-button-bg: var(--v-primary);
  --primary-button-hover-bg: color-mix(in srgb, var(--v-primary), var(--v-text) 10%);
  --primary-button-text: var(--v-primary-text);
  --primary-button-focus-outline: var(--v-primary);

  /* Scroll-to-top button variables */
  --scroll-button-bg: var(--v-text);
  --scroll-button-icon: var(--v-bg);
  --scroll-button-icon-hover: var(--v-primary);

  /* Share section variables */
  --share-section-bg-start: hsl(210, 40%, 98%);
  --share-section-bg-end: #f1f5f9;
  --share-section-border: var(--v-border);

  /* Feedback widget variables */
  --feedback-positive-color: #22c55e;
  --feedback-positive-bg: rgba(34, 197, 94, 0.1);
  --feedback-negative-color: #ef4444;
  --feedback-negative-bg: rgba(239, 68, 68, 0.1);
  --feedback-submit-button-text: #dbd7ca;

  --header-height: 5rem; /* 80px */

  /* Newspaper-style article layout */
  --article-intro-section-spacing: 2.5rem;
  --article-max-width: 880px; /* 1440px; */
  --article-padding-x-mobile: 1rem;
  --article-padding-x-tablet: 2rem;
  --article-padding-x-desktop: 3rem;

  /* Metadata section */
  --metadata-border-color: var(--v-border);
  --metadata-text-subtle: var(--v-text-muted);
  --metadata-spacing: 1rem;
  --metadata-section-gap: 1.5rem;

  /* Tag pills */
  --tag-pill-bg: var(--blog-tag-bg);
  --tag-pill-text: var(--blog-tag-text);
  --tag-pill-border: var(--blog-tag-border);
  --tag-pill-radius: 9999px;
  --tag-pill-padding-x: 0.75rem;
  --tag-pill-padding-y: 0.375rem;

  /* Author section */
  --author-avatar-size: 3rem;
  --author-name-weight: 700;
  --author-title-color: var(--v-text-muted);
  --author-section-gap: 0.75rem;
}

.dark {
  /* Core Vitesse Black Palette */
  --v-bg: #000000;
  --v-bg-soft: #121212;
  --v-border: #191919;
  --v-text: #dbd7ca;
  --v-text-muted: #959da5;
  --v-primary: #4d9375;
  --v-primary-text: #000000;
  --v-warning: #d4976c;
  --v-shadow-color: #000000;
  --v-button-bg-blue: #6394bf;
  --v-button-bg-hover: #4d9375;

  /* General variables are automatically updated via the core palette */

  /* Component-specific variables */
  --header-bg: color-mix(in srgb, var(--v-bg-soft), transparent 30%);
  --toggle-active-bg: color-mix(in srgb, var(--v-text), transparent 85%);
  --toggle-inactive-hover-bg: var(--v-bg-soft);

  /* PageMenu variables */
  --menu-bg: var(--v-bg-soft);
  --menu-item-hover-bg: color-mix(in srgb, var(--v-text), transparent 90%);

  /* Button variables */
  --share-button-text: #292825;
  --share-button-bg: var(--v-button-bg-blue);
  --share-button-hover-bg: var(--v-button-bg-hover);

  /* Blog tags */
  --blog-tag-bg: color-mix(in srgb, var(--v-primary), transparent 80%);
  --blog-tag-text: var(--v-primary);
  --blog-tag-border: color-mix(in srgb, var(--v-primary), transparent 70%);

  /* Blog title */
  --blog-title-color: var(--v-text);

  /* Blog table of contents */
  --blog-toc-bg: var(--v-bg);

  /* Blog Tip */
  --blog-tip-bg: color-mix(in srgb, var(--v-warning), transparent 85%);
  --blog-tip-text: var(--v-warning);
  --blog-tip-border: color-mix(in srgb, var(--v-warning), transparent 70%);
  --blog-tip-inline-code-bg: color-mix(in srgb, var(--v-warning), transparent 80%);
  --blog-tip-inline-code-text: var(--v-warning);

  /* Blog prose headings */
  --blog-prose-headings: var(--v-text);

  /* Blog inline code */
  --blog-inline-code-bg: var(--v-bg-soft);
  --blog-inline-code-text: var(--v-text);

  /* Blog post card variables */
  --blog-card-bg: var(--v-bg);
  --blog-card-shadow: color-mix(in srgb, var(--v-shadow-color), transparent 80%);
  --blog-card-shadow-hover: color-mix(in srgb, var(--v-shadow-color), transparent 70%);
  --blog-card-title-color: var(--v-text);

  /* Button variables */
  --primary-button-hover-bg: color-mix(in srgb, var(--v-primary), var(--v-text) 10%);
  --primary-button-text: var(--v-primary-text);

  /* Scroll-to-top button variables */
  --scroll-button-bg: var(--v-text);
  --scroll-button-icon: var(--v-bg);

  /* Share section variables */
  --share-section-bg-start: #1a1a1a;
  --share-section-bg-end: #0f0f0f;
  --share-section-border: var(--v-border);

  /* Feedback widget variables */
  --feedback-positive-color: #4ade80;
  --feedback-positive-bg: rgba(74, 222, 128, 0.15);
  --feedback-negative-color: #f87171;
  --feedback-negative-bg: rgba(248, 113, 113, 0.15);
  --feedback-submit-button-text: #292825;
}

body {
  background-color: var(--bg-color);
  color: var(--text-color);
  transition:
    background-color 0.3s ease,
    color 0.3s ease;
}

/* For View Transitions API - no changes needed */
:root.in-theme-transition {
  &::view-transition-old(root) {
    animation-delay: 400ms;
  }

  &::view-transition-new(root) {
    animation: circle-in 400ms var(--svelte-easing-ease-in-out);
  }

  @media (prefers-reduced-motion: reduce) {
    &::view-transition-old(root) {
      animation-duration: 0ms;
    }

    &::view-transition-new(root) {
      animation-duration: 0ms;
    }
  }
}

@keyframes circle-in {
  from {
    clip-path: circle(0% at 100% 0%);
  }

  to {
    clip-path: circle(140% at 100% 0%);
  }
}

/* Blog prose styling overrides - updated to use new variables */
.prose {
  /* Ensure proper text wrapping and word breaking */
  word-wrap: break-word;
  overflow-wrap: break-word;
  word-break: break-word;

  /* Remove default Typography plugin backticks from inline code */
  & code::before {
    content: none;
  }

  & code::after {
    content: none;
  }

  /* Fix heading colors and remove underlines from header links */
  & h1,
  & h2,
  & h3,
  & h4,
  & h5,
  & h6 {
    color: var(--blog-prose-headings);
    font-family: var(--font-serif);

    & a {
      text-decoration: none;
      color: inherit;

      &:hover {
        text-decoration: none;
      }
    }
  }

  /* Ensure proper text contrast and wrapping */
  & p,
  & li {
    color: var(--text-color);
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  /* Address bold and emphasis colors */
  & strong {
    color: var(--text-color);
  }

  & em {
    color: var(--text-color);
  }

  /* Fix link colors */
  & a:not(h1 a):not(h2 a):not(h3 a):not(h4 a):not(h5 a):not(h6 a) {
    color: var(--blog-toc-link);

    &:hover {
      color: var(--blog-toc-link-hover);
    }
  }

  /* Inline code styling */
  & code:not(pre code) {
    background-color: var(--blog-inline-code-bg);
    color: var(--blog-inline-code-text);
    font-family:
      ui-monospace, SFMono-Regular, 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace;
    font-size: 0.875em;
    padding: 0.125rem 0.25rem;
    border-radius: 0.25rem;
    font-weight: 600;
    word-break: break-all;
  }

  /* Code block container styling */
  & pre {
    max-width: 100%;
    overflow-x: auto;
    overflow-y: hidden;
    word-wrap: normal;
    white-space: pre;

    & code {
      word-break: normal;
      white-space: pre;
    }
  }
}

/* Tip component styling */
.tip-container {
  & p,
  & li {
    color: var(--blog-tip-text);
  }
}

/* Tip component prose overrides */
.prose.tip-prose {
  & p,
  & li,
  & code:not(pre code) {
    color: var(--blog-tip-text);
  }

  & strong,
  & em {
    color: var(--blog-tip-text);
  }

  /* Keep the inline code background styling */
  & code:not(pre code) {
    background-color: var(--blog-tip-inline-code-bg);
    color: var(--blog-tip-inline-code-text);
  }
}

/* Remove unwanted margins from Shiki code blocks and handle overflow */
.prose pre.shiki {
  margin-top: 0;
  margin-bottom: 0;
  max-width: 100%;
  overflow-x: auto;
  overflow-y: hidden;
}
